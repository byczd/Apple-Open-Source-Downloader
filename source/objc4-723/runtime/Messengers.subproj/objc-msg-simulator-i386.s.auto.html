<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>objc-msg-simulator-i386.s</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">objc-msg-simulator-i386.s&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="objc-msg-simulator-i386.s">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
/*
 <span class="enscript-keyword">*</span> Copyright (c) 1999-2009 Apple Inc.  All Rights Reserved.
 <span class="enscript-keyword">*</span> 
 <span class="enscript-keyword">*</span> @APPLE_LICENSE_HEADER_START@
 <span class="enscript-keyword">*</span> 
 <span class="enscript-keyword">*</span> This file contains Original Code and/or Modifications of Original Code
 <span class="enscript-keyword">*</span> as defined in and that are subject to the Apple Public Source License
 <span class="enscript-keyword">*</span> Version 2.0 (the 'License'). You may not use this file except in
 <span class="enscript-keyword">*</span> compliance with the License. Please obtain a copy of the License at
 <span class="enscript-keyword">*</span> <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this
 <span class="enscript-keyword">*</span> file.
 <span class="enscript-keyword">*</span> 
 <span class="enscript-keyword">*</span> The Original Code and all software distributed under the License are
 <span class="enscript-keyword">*</span> distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 <span class="enscript-keyword">*</span> EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 <span class="enscript-keyword">*</span> INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 <span class="enscript-keyword">*</span> FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 <span class="enscript-keyword">*</span> Please see the License for the specific language governing rights and
 <span class="enscript-keyword">*</span> limitations under the License.
 <span class="enscript-keyword">*</span> 
 <span class="enscript-keyword">*</span> @APPLE_LICENSE_HEADER_END@
 <span class="enscript-keyword">*/
</span>
#include &lt;TargetConditionals.h&gt;
#if defined(__i386__)  &amp;&amp;  TARGET_OS_SIMULATOR

#include <span class="enscript-string">&quot;objc-config.h&quot;</span>

.data

// _objc_entryPoints and _objc_exitPoints are used by objc
// to get the critical regions for which method caches 
// cannot be garbage collected.

.align 2
.private_extern _objc_entryPoints
<span class="enscript-function-name">_objc_entryPoints:</span>
	<span class="enscript-keyword">.long</span>	_cache_getImp
	<span class="enscript-keyword">.long</span>	_objc_msgSend
	<span class="enscript-keyword">.long</span>	_objc_msgSend_fpret
	<span class="enscript-keyword">.long</span>	_objc_msgSend_stret
	<span class="enscript-keyword">.long</span>	_objc_msgSendSuper
	<span class="enscript-keyword">.long</span>	_objc_msgSendSuper2
	<span class="enscript-keyword">.long</span>	_objc_msgSendSuper_stret
	<span class="enscript-keyword">.long</span>	_objc_msgSendSuper2_stret
	<span class="enscript-keyword">.long</span>	_objc_msgLookup
	<span class="enscript-keyword">.long</span>	_objc_msgLookup_fpret
	<span class="enscript-keyword">.long</span>	_objc_msgLookup_stret
	<span class="enscript-keyword">.long</span>	_objc_msgLookupSuper2
	<span class="enscript-keyword">.long</span>	_objc_msgLookupSuper2_stret
	<span class="enscript-keyword">.long</span>	0

.private_extern _objc_exitPoints
<span class="enscript-function-name">_objc_exitPoints:</span>
	<span class="enscript-keyword">.long</span>	LExit_cache_getImp
	<span class="enscript-keyword">.long</span>	LExit_objc_msgSend
	<span class="enscript-keyword">.long</span>	LExit_objc_msgSend_fpret
	<span class="enscript-keyword">.long</span>	LExit_objc_msgSend_stret
	<span class="enscript-keyword">.long</span>	LExit_objc_msgSendSuper
	<span class="enscript-keyword">.long</span>	LExit_objc_msgSendSuper2
	<span class="enscript-keyword">.long</span>	LExit_objc_msgSendSuper_stret
	<span class="enscript-keyword">.long</span>	LExit_objc_msgSendSuper2_stret
	<span class="enscript-keyword">.long</span>	LExit_objc_msgLookup
	<span class="enscript-keyword">.long</span>	LExit_objc_msgLookup_fpret
	<span class="enscript-keyword">.long</span>	LExit_objc_msgLookup_stret
	<span class="enscript-keyword">.long</span>	LExit_objc_msgLookupSuper2
	<span class="enscript-keyword">.long</span>	LExit_objc_msgLookupSuper2_stret
	<span class="enscript-keyword">.long</span>	0


/********************************************************************
* List every exit insn from every messenger for debugger use.
* Format:
* (
*   1 word instruction's address
*   1 word type (ENTER or FAST_EXIT or SLOW_EXIT or NIL_EXIT)
* )
* 1 word zero
*
* ENTER is the start of a dispatcher
* FAST_EXIT is method dispatch
* SLOW_EXIT is uncached method lookup
* NIL_EXIT is returning zero from a message sent to nil
* These must match objc-gdb.h.
********************************************************************/
	<span class="enscript-keyword">
</span>#define ENTER     1
#define FAST_EXIT 2
#define SLOW_EXIT 3
#define NIL_EXIT  4

.section __DATA,__objc_msg_break
.globl _gdb_objc_messenger_breakpoints
<span class="enscript-function-name">_gdb_objc_messenger_breakpoints:</span>
// contents populated by the macros below

.macro MESSENGER_START
<span class="enscript-function-name">4:</span>
	<span class="enscript-keyword">.section</span> __DATA,__objc_msg_break
	<span class="enscript-keyword">.long</span> 4b
	<span class="enscript-keyword">.long</span> ENTER
	<span class="enscript-keyword">.text
</span>.endmacro
.macro MESSENGER_END_FAST
<span class="enscript-function-name">4:</span>
	<span class="enscript-keyword">.section</span> __DATA,__objc_msg_break
	<span class="enscript-keyword">.long</span> 4b
	<span class="enscript-keyword">.long</span> FAST_EXIT
	<span class="enscript-keyword">.text
</span>.endmacro
.macro MESSENGER_END_SLOW
<span class="enscript-function-name">4:</span>
	<span class="enscript-keyword">.section</span> __DATA,__objc_msg_break
	<span class="enscript-keyword">.long</span> 4b
	<span class="enscript-keyword">.long</span> SLOW_EXIT
	<span class="enscript-keyword">.text
</span>.endmacro
.macro MESSENGER_END_NIL
<span class="enscript-function-name">4:</span>
	<span class="enscript-keyword">.section</span> __DATA,__objc_msg_break
	<span class="enscript-keyword">.long</span> 4b
	<span class="enscript-keyword">.long</span> NIL_EXIT
	<span class="enscript-keyword">.text
</span>.endmacro


/********************************************************************
 <span class="enscript-keyword">*</span> Names for relative labels
 <span class="enscript-keyword">*</span> DO NOT USE THESE LABELS ELSEWHERE
 <span class="enscript-keyword">*</span> Reserved labels: 5: 6: 7: 8: 9:
 <span class="enscript-keyword">********************************************************************/
</span>#define LCacheMiss 	5
#define LCacheMiss_f 	5f
#define LCacheMiss_b 	5b
#define LNilTestDone 	6
#define LNilTestDone_f 	6f
#define LNilTestDone_b 	6b
#define LNilTestSlow 	7
#define LNilTestSlow_f 	7f
#define LNilTestSlow_b 	7b
#define LGetIsaDone 	8
#define LGetIsaDone_f 	8f
#define LGetIsaDone_b 	8b
#define LGetIsaSlow 	9
#define LGetIsaSlow_f 	9f
#define LGetIsaSlow_b 	9b

/********************************************************************
 <span class="enscript-keyword">*</span> Macro parameters
 <span class="enscript-keyword">********************************************************************/
</span>

#define NORMAL 0
#define FPRET 1
#define STRET 2

#define CALL 100
#define GETIMP 101
#define LOOKUP 102


/********************************************************************
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> Structure definitions.
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">********************************************************************/
</span>
// Offsets from %esp
#define self            4
#define super           4
#define selector        8
#define marg_size       12
#define marg_list       16
#define first_arg       12

#define struct_addr     4

#define self_stret      8
#define super_stret     8
#define selector_stret  12
#define marg_size_stret 16
#define marg_list_stret 20

// objc_super parameter to sendSuper
#define receiver        0
#define class           4

// Selected field offsets in class structure
#define isa             0
#define superclass	4

// Method descriptor
#define method_name     0
#define method_imp      8


//////////////////////////////////////////////////////////////////////
//
// ENTRY		functionName
//
// Assembly directives to begin an exported function.
//
// Takes: functionName - name of the exported function
//////////////////////////////////////////////////////////////////////

.macro ENTRY
	<span class="enscript-keyword">.text
</span>	<span class="enscript-keyword">.globl</span>	$0
	<span class="enscript-keyword">.align</span>	2, 0x90
<span class="enscript-function-name">$0:</span>
.endmacro

.macro STATIC_ENTRY
	<span class="enscript-keyword">.text
</span>	<span class="enscript-keyword">.private_extern</span>	$0
	<span class="enscript-keyword">.align</span>	4, 0x90
<span class="enscript-function-name">$0:</span>
.endmacro

//////////////////////////////////////////////////////////////////////
//
// END_ENTRY	functionName
//
// Assembly directives to end an exported function.  Just a placeholder,
// a close-parenthesis for ENTRY, until it is needed for something.
//
// Takes: functionName - name of the exported function
//////////////////////////////////////////////////////////////////////

.macro END_ENTRY
<span class="enscript-function-name">LExit$0:</span>
.endmacro


 <span class="enscript-keyword">/********************************************************************
</span> <span class="enscript-keyword">*</span> UNWIND name, flags
 <span class="enscript-keyword">*</span> Unwind info generation	
 <span class="enscript-keyword">********************************************************************/
</span>.macro UNWIND
	<span class="enscript-keyword">.section</span> __LD,__compact_unwind,regular,debug
	<span class="enscript-keyword">.long</span> $0
	<span class="enscript-keyword">.set</span>  LUnwind$0, LExit$0 - $0
	<span class="enscript-keyword">.long</span> LUnwind$0
	<span class="enscript-keyword">.long</span> $1
	<span class="enscript-keyword">.long</span> 0	 /* no personality */
	<span class="enscript-keyword">.long</span> 0  /* no LSDA */
	<span class="enscript-keyword">.text
</span>.endmacro

#define NoFrame 0x02010000  // no frame, no SP adjustment except return address
#define FrameWithNoSaves 0x01000000  // frame, no non-volatile saves


/////////////////////////////////////////////////////////////////////
//
// CacheLookup	return-type, caller
//
// Locate the implementation for a selector in a class method cache.
//
// Takes: 
//	  $0 = NORMAL, FPRET, STRET
//	  $1 = CALL, LOOKUP, GETIMP
//	  ecx = selector to search for
//	  edx = class to search
//
// On exit: ecx clobbered
//	    (found) calls or returns IMP in eax, eq/ne set for forwarding
//	    (not found) jumps to LCacheMiss, class still in edx
//
/////////////////////////////////////////////////////////////////////

.macro CacheHit

	<span class="enscript-keyword">//</span> CacheHit must always be preceded by a not-taken `jne` instruction
	<span class="enscript-keyword">//</span> in case the imp is _objc_msgForward_impcache.

	<span class="enscript-keyword">//</span> eax = found bucket
	<span class="enscript-keyword">
</span>.if $1 == GETIMP
	<span class="enscript-keyword">movl</span>	4(%eax), %eax		// return imp
	<span class="enscript-keyword">ret
</span>
.else

.if $0 != STRET
	<span class="enscript-keyword">//</span> eq already set for forwarding by `jne`
.else
	<span class="enscript-keyword">test</span>	%eax, %eax		// set ne for stret forwarding
.endif

.if $1 == CALL
	<span class="enscript-keyword">MESSENGER_END_FAST
</span>	<span class="enscript-keyword">jmp</span>	*4(%eax)		// call imp

.elseif $1 == LOOKUP
	<span class="enscript-keyword">movl</span>	4(%eax), %eax		// return imp
	<span class="enscript-keyword">ret
</span>
.else
.abort oops
.endif

.endif

.endmacro


.macro	CacheLookup

	<span class="enscript-keyword">movzwl</span>	12(%edx), %eax		// eax = mask
	<span class="enscript-keyword">andl</span>	%ecx, %eax		// eax = SEL &amp; mask
	<span class="enscript-keyword">shll</span>	$$3, %eax		// eax = offset = (SEL &amp; mask) * 8
	<span class="enscript-keyword">addl</span>	8(%edx), %eax		// eax = bucket = cache-&gt;buckets+offset
	<span class="enscript-keyword">cmpl</span>	(%eax), %ecx		// if (bucket-&gt;sel != SEL)
	<span class="enscript-keyword">jne</span>	1f			//     scan more
	<span class="enscript-keyword">//</span> The `jne` above sets flags for CacheHit
	<span class="enscript-keyword">CacheHit</span> $0, $1			// call or return imp

<span class="enscript-function-name">1:</span>
	<span class="enscript-keyword">//</span> loop
	<span class="enscript-keyword">cmpl</span>	$$1, (%eax)
	<span class="enscript-keyword">jbe</span>	3f			// if (bucket-&gt;sel &lt;= 1) wrap or miss
	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">addl</span>	$$8, %eax		// bucket++
<span class="enscript-function-name">2:</span>
	<span class="enscript-keyword">cmpl</span>	(%eax), %ecx		// if (bucket-&gt;sel != sel)
	<span class="enscript-keyword">jne</span>	1b			//     scan more
	<span class="enscript-keyword">//</span> The `jne` above sets flags for CacheHit
	<span class="enscript-keyword">CacheHit</span> $0, $1			// call or return imp

<span class="enscript-function-name">3:</span>	
	<span class="enscript-keyword">//</span> wrap or miss
	<span class="enscript-keyword">jb</span>	LCacheMiss_f		// if (bucket-&gt;sel &lt; 1) cache miss
	<span class="enscript-keyword">//</span> wrap
	<span class="enscript-keyword">movl</span>	4(%eax), %eax		// bucket-&gt;imp is really first bucket
	<span class="enscript-keyword">jmp</span>	2f

	<span class="enscript-keyword">//</span> Clone scanning loop to miss instead of hang when cache is corrupt.
	<span class="enscript-keyword">//</span> The slow path may detect any corruption and halt later.

<span class="enscript-function-name">1:</span>
	<span class="enscript-keyword">//</span> loop
	<span class="enscript-keyword">cmpq</span>	$$1, (%eax)
	<span class="enscript-keyword">jbe</span>	3f			// if (bucket-&gt;sel &lt;= 1) wrap or miss
	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">addl</span>	$$8, %eax		// bucket++
<span class="enscript-function-name">2:</span>
	<span class="enscript-keyword">cmpl</span>	(%eax), %ecx		// if (bucket-&gt;sel != sel)
	<span class="enscript-keyword">jne</span>	1b			//     scan more
	<span class="enscript-keyword">//</span> The `jne` above sets flags for CacheHit
	<span class="enscript-keyword">CacheHit</span> $0, $1			// call or return imp

<span class="enscript-function-name">3:</span>	
	<span class="enscript-keyword">//</span> double wrap or miss
	<span class="enscript-keyword">jmp</span>	LCacheMiss_f
	<span class="enscript-keyword">
</span>.endmacro


/////////////////////////////////////////////////////////////////////
//
// MethodTableLookup NORMAL|STRET
//
// Takes:
//	  receiver (not struct objc_super) and selector on stack
// 	  edx = class to search
//
// On exit: IMP in eax, eq/ne set for forwarding
//
/////////////////////////////////////////////////////////////////////

.macro MethodTableLookup
	<span class="enscript-keyword">pushl</span>	%ebp
	<span class="enscript-keyword">movl</span>	%esp, %ebp

	<span class="enscript-keyword">subl</span>	$$(8+5*16), %esp

.if $0 == NORMAL
	<span class="enscript-keyword">movl</span>	self+4(%ebp), %eax
	<span class="enscript-keyword">movl</span>    selector+4(%ebp), %ecx
.else
	<span class="enscript-keyword">movl</span>	self_stret+4(%ebp), %eax
	<span class="enscript-keyword">movl</span>    selector_stret+4(%ebp), %ecx
.endif
	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">movdqa</span>  %xmm3, 4*16(%esp)
	<span class="enscript-keyword">movdqa</span>  %xmm2, 3*16(%esp)
	<span class="enscript-keyword">movdqa</span>  %xmm1, 2*16(%esp)
	<span class="enscript-keyword">movdqa</span>  %xmm0, 1*16(%esp)
	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">movl</span>	%edx, 8(%esp)		// class
	<span class="enscript-keyword">movl</span>	%ecx, 4(%esp)		// selector
	<span class="enscript-keyword">movl</span>	%eax, 0(%esp)		// receiver
	<span class="enscript-keyword">call</span>	__class_lookupMethodAndLoadCache3

	<span class="enscript-keyword">//</span> imp in eax

	<span class="enscript-keyword">movdqa</span>  4*16(%esp), %xmm3
	<span class="enscript-keyword">movdqa</span>  3*16(%esp), %xmm2
	<span class="enscript-keyword">movdqa</span>  2*16(%esp), %xmm1
	<span class="enscript-keyword">movdqa</span>  1*16(%esp), %xmm0

.if $0 == NORMAL
	<span class="enscript-keyword">cmp</span>	%eax, %eax	// set eq for nonstret forwarding
.else
	<span class="enscript-keyword">test</span>	%eax, %eax	// set ne for stret forwarding
.endif

	<span class="enscript-keyword">leave
</span>
.endmacro


/////////////////////////////////////////////////////////////////////
//
// NilTest return-type
//
// Takes:	$0 = NORMAL or FPRET or STRET
//		eax = receiver
//
// On exit: 	Loads non-nil receiver in eax and self(esp) or self_stret(esp),
//		or returns zero.
//
// NilTestReturnZero return-type
//
// Takes:	$0 = NORMAL or FPRET or STRET
//		eax = receiver
//
// On exit: 	Loads non-nil receiver in eax and self(esp) or self_stret(esp),
//		or returns zero.
//
// NilTestReturnIMP return-type
//
// Takes:	$0 = NORMAL or FPRET or STRET
//		eax = receiver
//
// On exit: 	Loads non-nil receiver in eax and self(esp) or self_stret(esp),
//		or returns an IMP in eax that returns zero.
//
/////////////////////////////////////////////////////////////////////

.macro ZeroReturn
	<span class="enscript-keyword">xorl</span>	%eax, %eax
	<span class="enscript-keyword">xorl</span>	%edx, %edx
	<span class="enscript-keyword">xorps</span>	%xmm0, %xmm0
	<span class="enscript-keyword">xorps</span>	%xmm1, %xmm1
.endmacro

.macro ZeroReturnFPRET
	<span class="enscript-keyword">fldz
</span>.endmacro

.macro ZeroReturnSTRET
	<span class="enscript-keyword">//</span> empty
.endmacro

	<span class="enscript-keyword">STATIC_ENTRY</span> __objc_msgNil
	<span class="enscript-keyword">ZeroReturn
</span>	<span class="enscript-keyword">ret
</span>	<span class="enscript-keyword">END_ENTRY</span> __objc_msgNil

	<span class="enscript-keyword">STATIC_ENTRY</span> __objc_msgNil_fpret
	<span class="enscript-keyword">ZeroReturnFPRET
</span>	<span class="enscript-keyword">ret
</span>	<span class="enscript-keyword">END_ENTRY</span> __objc_msgNil_fpret

	<span class="enscript-keyword">STATIC_ENTRY</span> __objc_msgNil_stret
	<span class="enscript-keyword">ZeroReturnSTRET
</span>	<span class="enscript-keyword">ret</span> $4
	<span class="enscript-keyword">END_ENTRY</span> __objc_msgNil_stret


.macro NilTest
	<span class="enscript-keyword">testl</span>	%eax, %eax
	<span class="enscript-keyword">jz</span>	LNilTestSlow_f
<span class="enscript-function-name">LNilTestDone:</span>
.endmacro

.macro NilTestReturnZero
	<span class="enscript-keyword">.align</span> 3
<span class="enscript-function-name">LNilTestSlow:</span>

.if $0 == NORMAL
	<span class="enscript-keyword">ZeroReturn
</span>	<span class="enscript-keyword">MESSENGER_END_NIL
</span>	<span class="enscript-keyword">ret
</span>.elseif $0 == FPRET
	<span class="enscript-keyword">ZeroReturnFPRET
</span>	<span class="enscript-keyword">MESSENGER_END_NIL
</span>	<span class="enscript-keyword">ret
</span>.elseif $0 == STRET
	<span class="enscript-keyword">ZeroReturnSTRET
</span>	<span class="enscript-keyword">MESSENGER_END_NIL
</span>	<span class="enscript-keyword">ret</span> $$4
.else
.abort oops
.endif
.endmacro

.macro NilTestReturnIMP
	<span class="enscript-keyword">.align</span> 3
<span class="enscript-function-name">LNilTestSlow:</span>

	<span class="enscript-keyword">call</span>	1f
<span class="enscript-function-name">1:</span>	pop	%eax
.if $0 == NORMAL
	<span class="enscript-keyword">leal</span>	__objc_msgNil-1b(%eax), %eax
.elseif $0 == FPRET
	<span class="enscript-keyword">leal</span>	__objc_msgNil_fpret-1b(%eax), %eax
.elseif $0 == STRET
	<span class="enscript-keyword">leal</span>	__objc_msgNil_stret-1b(%eax), %eax
.else
.abort oops
.endif
	<span class="enscript-keyword">ret
</span>.endmacro


/********************************************************************
 <span class="enscript-keyword">*</span> IMP _cache_getImp(Class cls, SEL sel)
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> If found, returns method implementation.
 <span class="enscript-keyword">*</span> If not found, returns NULL.
 <span class="enscript-keyword">********************************************************************/
</span>
	<span class="enscript-keyword">STATIC_ENTRY</span> _cache_getImp

// load the class and selector
	<span class="enscript-keyword">movl</span>    selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	self(%esp), %edx

	<span class="enscript-keyword">CacheLookup</span> NORMAL, GETIMP	// returns IMP on success

<span class="enscript-function-name">LCacheMiss:</span>
// cache miss, return nil
	<span class="enscript-keyword">xorl</span>    %eax, %eax
	<span class="enscript-keyword">ret
</span>
	<span class="enscript-keyword">END_ENTRY</span> _cache_getImp


/********************************************************************
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> id objc_msgSend(id self, SEL _cmd, ...)<span class="enscript-comment">;
 * IMP objc_msgLookup(id self, SEL _cmd, ...);
</span> <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> objc_msgLookup ABI:
 <span class="enscript-keyword">*</span> IMP returned in eax
 <span class="enscript-keyword">*</span> Forwarding returned in Z flag
 <span class="enscript-keyword">*</span> edx reserved for our use but not used
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">********************************************************************/
</span>
	<span class="enscript-keyword">ENTRY</span> _objc_msgSend
	<span class="enscript-keyword">UNWIND</span> _objc_msgSend, NoFrame
	<span class="enscript-keyword">MESSENGER_START
</span>	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">movl</span>    selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	self(%esp), %eax

	<span class="enscript-keyword">NilTest</span> NORMAL

	<span class="enscript-keyword">movl</span>	isa(%eax), %edx		// class = self-&gt;isa
	<span class="enscript-keyword">CacheLookup</span> NORMAL, CALL	// calls IMP on success

	<span class="enscript-keyword">NilTestReturnZero</span> NORMAL

<span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> isa still in edx
	<span class="enscript-keyword">MESSENGER_END_SLOW
</span>	<span class="enscript-keyword">jmp</span>	__objc_msgSend_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSend


	<span class="enscript-keyword">ENTRY</span> _objc_msgLookup
	<span class="enscript-keyword">UNWIND</span> _objc_msgLookup, NoFrame
	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">movl</span>    selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	self(%esp), %eax

	<span class="enscript-keyword">NilTest</span> NORMAL

	<span class="enscript-keyword">movl</span>	isa(%eax), %edx		// class = self-&gt;isa
	<span class="enscript-keyword">CacheLookup</span> NORMAL, LOOKUP	// returns IMP on success

	<span class="enscript-keyword">NilTestReturnIMP</span> NORMAL

<span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> isa still in edx
	<span class="enscript-keyword">jmp</span>	__objc_msgLookup_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgLookup


/********************************************************************
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> id objc_msgSendSuper(struct objc_super *super, SEL _cmd, ...)<span class="enscript-comment">;
 * IMP objc_msgLookupSuper(struct objc_super *super, SEL _cmd, ...);
</span> <span class="enscript-keyword">*
</span> <span class="enscript-keyword">********************************************************************/
</span>
	<span class="enscript-keyword">ENTRY</span> _objc_msgSendSuper
	<span class="enscript-keyword">UNWIND</span> _objc_msgSendSuper, NoFrame
	<span class="enscript-keyword">MESSENGER_START
</span>
	<span class="enscript-keyword">movl</span>    selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	super(%esp), %eax	// struct objc_super
	<span class="enscript-keyword">movl</span>	class(%eax), %edx	// struct objc_super-&gt;class
	<span class="enscript-keyword">movl</span>	receiver(%eax), %eax	// struct objc_super-&gt;receiver
	<span class="enscript-keyword">movl</span>	%eax, super(%esp)	// replace super arg with receiver
	<span class="enscript-keyword">CacheLookup</span> NORMAL, CALL	// calls IMP on success

<span class="enscript-function-name">LCacheMiss:</span>	
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">MESSENGER_END_SLOW
</span>	<span class="enscript-keyword">jmp</span>	__objc_msgSend_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSendSuper



	<span class="enscript-keyword">ENTRY</span> _objc_msgLookupSuper
	<span class="enscript-keyword">UNWIND</span> _objc_msgLookupSuper, NoFrame

	<span class="enscript-keyword">movl</span>    selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	super(%esp), %eax	// struct objc_super
	<span class="enscript-keyword">movl</span>	class(%eax), %edx	// struct objc_super-&gt;class
	<span class="enscript-keyword">movl</span>	receiver(%eax), %eax	// struct objc_super-&gt;receiver
	<span class="enscript-keyword">movl</span>	%eax, super(%esp)	// replace super arg with receiver
	<span class="enscript-keyword">CacheLookup</span> NORMAL, LOOKUP	// returns IMP on success

<span class="enscript-function-name">LCacheMiss:</span>	
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">jmp</span>	__objc_msgLookup_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgLookupSuper


/********************************************************************
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> id objc_msgSendSuper2(struct objc_super *super, SEL _cmd, ...)<span class="enscript-comment">;
 * IMP objc_msgLookupSuper2(struct objc_super *super, SEL _cmd, ...);
</span> <span class="enscript-keyword">*
</span> <span class="enscript-keyword">********************************************************************/
</span>
	<span class="enscript-keyword">ENTRY</span> _objc_msgSendSuper2
	<span class="enscript-keyword">UNWIND</span> _objc_msgSendSuper2, NoFrame
	<span class="enscript-keyword">MESSENGER_START
</span>
	<span class="enscript-keyword">movl</span>    selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	super(%esp), %eax	// struct objc_super
	<span class="enscript-keyword">movl</span>	class(%eax), %edx	// struct objc_super-&gt;class
	<span class="enscript-keyword">movl</span>	receiver(%eax), %eax	// struct objc_super-&gt;receiver
	<span class="enscript-keyword">movl</span>	%eax, super(%esp)	// replace super arg with receiver
	<span class="enscript-keyword">movl</span>	superclass(%edx), %edx	// edx = objc_super-&gt;class-&gt;super_class
	<span class="enscript-keyword">CacheLookup</span> NORMAL, CALL	// calls IMP on success

<span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">MESSENGER_END_SLOW
</span>	<span class="enscript-keyword">jmp</span>	__objc_msgSend_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSendSuper2


	<span class="enscript-keyword">ENTRY</span> _objc_msgLookupSuper2
	<span class="enscript-keyword">UNWIND</span> _objc_msgLookupSuper2, NoFrame

	<span class="enscript-keyword">movl</span>    selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	super(%esp), %eax	// struct objc_super
	<span class="enscript-keyword">movl</span>	class(%eax), %edx	// struct objc_super-&gt;class
	<span class="enscript-keyword">movl</span>	receiver(%eax), %eax	// struct objc_super-&gt;receiver
	<span class="enscript-keyword">movl</span>	%eax, super(%esp)	// replace super arg with receiver
	<span class="enscript-keyword">movl</span>	superclass(%edx), %edx	// edx = objc_super-&gt;class-&gt;super_class
	<span class="enscript-keyword">CacheLookup</span> NORMAL, LOOKUP	// returns IMP on success

<span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">jmp</span>	__objc_msgLookup_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgLookupSuper2


/********************************************************************
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> double objc_msgSend_fpret(id self, SEL _cmd, ...)<span class="enscript-comment">;
 * IMP objc_msgLookup_fpret(id self, SEL _cmd, ...);
</span> <span class="enscript-keyword">*
</span> <span class="enscript-keyword">********************************************************************/
</span>
	<span class="enscript-keyword">ENTRY</span> _objc_msgSend_fpret
	<span class="enscript-keyword">UNWIND</span> _objc_msgSend_fpret, NoFrame
	<span class="enscript-keyword">MESSENGER_START
</span>
	<span class="enscript-keyword">movl</span>    selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	self(%esp), %eax

	<span class="enscript-keyword">NilTest</span> FPRET

	<span class="enscript-keyword">movl</span>	isa(%eax), %edx		// class = self-&gt;isa
	<span class="enscript-keyword">CacheLookup</span> FPRET, CALL		// calls IMP on success

	<span class="enscript-keyword">NilTestReturnZero</span> FPRET
	<span class="enscript-keyword">
</span><span class="enscript-function-name">LCacheMiss:</span>	
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">MESSENGER_END_SLOW
</span>	<span class="enscript-keyword">jmp</span>	__objc_msgSend_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSend_fpret


	<span class="enscript-keyword">ENTRY</span> _objc_msgLookup_fpret
	<span class="enscript-keyword">UNWIND</span> _objc_msgLookup_fpret, NoFrame

	<span class="enscript-keyword">movl</span>    selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	self(%esp), %eax

	<span class="enscript-keyword">NilTest</span> FPRET

	<span class="enscript-keyword">movl</span>	isa(%eax), %edx		// class = self-&gt;isa
	<span class="enscript-keyword">CacheLookup</span> FPRET, LOOKUP	// returns IMP on success

	<span class="enscript-keyword">NilTestReturnIMP</span> FPRET
	<span class="enscript-keyword">
</span><span class="enscript-function-name">LCacheMiss:</span>	
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">jmp</span>	__objc_msgLookup_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgLookup_fpret
	<span class="enscript-keyword">
</span>
/********************************************************************
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> void objc_msgSend_stret(void *st_addr, id self, SEL _cmd, ...)<span class="enscript-comment">;
 * IMP objc_msgLookup_stret(void *st_addr, id self, SEL _cmd, ...);
</span> <span class="enscript-keyword">*
</span> <span class="enscript-keyword">********************************************************************/
</span>
	<span class="enscript-keyword">ENTRY</span> _objc_msgSend_stret
	<span class="enscript-keyword">UNWIND</span> _objc_msgSend_stret, NoFrame
	<span class="enscript-keyword">MESSENGER_START
</span>
	<span class="enscript-keyword">movl</span>	selector_stret(%esp), %ecx
	<span class="enscript-keyword">movl</span>	self_stret(%esp), %eax

	<span class="enscript-keyword">NilTest</span> STRET

	<span class="enscript-keyword">movl</span>	isa(%eax), %edx		// class = self-&gt;isa
	<span class="enscript-keyword">CacheLookup</span> STRET, CALL		// calls IMP on success

	<span class="enscript-keyword">NilTestReturnZero</span> STRET
	<span class="enscript-keyword">
</span><span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">MESSENGER_END_SLOW
</span>	<span class="enscript-keyword">jmp</span>	__objc_msgSend_stret_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSend_stret


	<span class="enscript-keyword">ENTRY</span> _objc_msgLookup_stret
	<span class="enscript-keyword">UNWIND</span> _objc_msgLookup_stret, NoFrame

	<span class="enscript-keyword">movl</span>	selector_stret(%esp), %ecx
	<span class="enscript-keyword">movl</span>	self_stret(%esp), %eax

	<span class="enscript-keyword">NilTest</span> STRET

	<span class="enscript-keyword">movl</span>	isa(%eax), %edx		// class = self-&gt;isa
	<span class="enscript-keyword">CacheLookup</span> STRET, LOOKUP	// returns IMP on success

	<span class="enscript-keyword">NilTestReturnIMP</span> STRET
	<span class="enscript-keyword">
</span><span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">jmp</span>	__objc_msgLookup_stret_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgLookup_stret

	<span class="enscript-keyword">
</span>/********************************************************************
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> void objc_msgSendSuper_stret(void *st_addr, struct objc_super *super, SEL _cmd, ...)<span class="enscript-comment">;
 * IMP objc_msgLookupSuper_stret(void *st_addr, struct objc_super *super, SEL _cmd, ...);
</span> <span class="enscript-keyword">*
</span> <span class="enscript-keyword">********************************************************************/
</span>
	<span class="enscript-keyword">ENTRY</span> _objc_msgSendSuper_stret
	<span class="enscript-keyword">UNWIND</span> _objc_msgSendSuper_stret, NoFrame
	<span class="enscript-keyword">MESSENGER_START
</span>
	<span class="enscript-keyword">movl</span>	selector_stret(%esp), %ecx
	<span class="enscript-keyword">movl</span>	super_stret(%esp), %eax	// struct objc_super
	<span class="enscript-keyword">movl</span>	class(%eax), %edx	// struct objc_super-&gt;class
	<span class="enscript-keyword">movl</span>	receiver(%eax), %eax	// struct objc_super-&gt;receiver
	<span class="enscript-keyword">movl</span>	%eax, super_stret(%esp)	// replace super arg with receiver
	<span class="enscript-keyword">CacheLookup</span> STRET, CALL		// calls IMP on success

<span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">MESSENGER_END_SLOW
</span>	<span class="enscript-keyword">jmp</span>	__objc_msgSend_stret_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSendSuper_stret


	<span class="enscript-keyword">ENTRY</span> _objc_msgLookupSuper_stret
	<span class="enscript-keyword">UNWIND</span> _objc_msgLookupSuper_stret, NoFrame

	<span class="enscript-keyword">movl</span>	selector_stret(%esp), %ecx
	<span class="enscript-keyword">movl</span>	super_stret(%esp), %eax	// struct objc_super
	<span class="enscript-keyword">movl</span>	class(%eax), %edx	// struct objc_super-&gt;class
	<span class="enscript-keyword">movl</span>	receiver(%eax), %eax	// struct objc_super-&gt;receiver
	<span class="enscript-keyword">movl</span>	%eax, super_stret(%esp)	// replace super arg with receiver
	<span class="enscript-keyword">CacheLookup</span> STRET, LOOKUP	// returns IMP on success

<span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">jmp</span>	__objc_msgLookup_stret_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgLookupSuper_stret


/********************************************************************
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> void objc_msgSendSuper2_stret(void *st_addr, struct objc_super *super, SEL _cmd, ...)<span class="enscript-comment">;
 * IMP objc_msgLookupSuper2_stret(void *st_addr, struct objc_super *super, SEL _cmd, ...);
</span> <span class="enscript-keyword">*
</span> <span class="enscript-keyword">********************************************************************/
</span>
	<span class="enscript-keyword">ENTRY</span> _objc_msgSendSuper2_stret
	<span class="enscript-keyword">UNWIND</span> _objc_msgSendSuper2_stret, NoFrame
	<span class="enscript-keyword">MESSENGER_START
</span>
	<span class="enscript-keyword">movl</span>	selector_stret(%esp), %ecx
	<span class="enscript-keyword">movl</span>	super_stret(%esp), %eax	// struct objc_super
	<span class="enscript-keyword">movl</span>	class(%eax), %edx	// struct objc_super-&gt;class
	<span class="enscript-keyword">movl</span>	receiver(%eax), %eax	// struct objc_super-&gt;receiver
	<span class="enscript-keyword">movl</span>	%eax, super_stret(%esp)	// replace super arg with receiver
	<span class="enscript-keyword">mov</span>	superclass(%edx), %edx	// edx = objc_super-&gt;class-&gt;super_class
	<span class="enscript-keyword">CacheLookup</span> STRET, CALL		// calls IMP on success

// cache miss: go search the method lists
<span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">MESSENGER_END_SLOW
</span>	<span class="enscript-keyword">jmp</span>	__objc_msgSend_stret_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSendSuper2_stret


	<span class="enscript-keyword">ENTRY</span> _objc_msgLookupSuper2_stret
	<span class="enscript-keyword">UNWIND</span> _objc_msgLookupSuper2_stret, NoFrame

	<span class="enscript-keyword">movl</span>	selector_stret(%esp), %ecx
	<span class="enscript-keyword">movl</span>	super_stret(%esp), %eax	// struct objc_super
	<span class="enscript-keyword">movl</span>	class(%eax), %edx	// struct objc_super-&gt;class
	<span class="enscript-keyword">movl</span>	receiver(%eax), %eax	// struct objc_super-&gt;receiver
	<span class="enscript-keyword">movl</span>	%eax, super_stret(%esp)	// replace super arg with receiver
	<span class="enscript-keyword">mov</span>	superclass(%edx), %edx	// edx = objc_super-&gt;class-&gt;super_class
	<span class="enscript-keyword">CacheLookup</span> STRET, LOOKUP	// returns IMP on success

// cache miss: go search the method lists
<span class="enscript-function-name">LCacheMiss:</span>
	<span class="enscript-keyword">//</span> class still in edx
	<span class="enscript-keyword">jmp</span>	__objc_msgLookup_stret_uncached

	<span class="enscript-keyword">END_ENTRY</span> _objc_msgLookupSuper2_stret


/********************************************************************
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> _objc_msgSend_uncached
 <span class="enscript-keyword">*</span> _objc_msgSend_stret_uncached
 <span class="enscript-keyword">*</span> _objc_msgLookup_uncached
 <span class="enscript-keyword">*</span> _objc_msgLookup_stret_uncached
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">*</span> The uncached method lookup.
 <span class="enscript-keyword">*
</span> <span class="enscript-keyword">********************************************************************/
</span>
	<span class="enscript-keyword">STATIC_ENTRY</span> __objc_msgSend_uncached
	<span class="enscript-keyword">UNWIND</span> __objc_msgSend_uncached, FrameWithNoSaves

	<span class="enscript-keyword">//</span> THIS IS NOT A CALLABLE C FUNCTION
	<span class="enscript-keyword">//</span> Out-of-band edx is the searched class

	<span class="enscript-keyword">//</span> edx is already the class to search
	<span class="enscript-keyword">MethodTableLookup</span> NORMAL
	<span class="enscript-keyword">jmp</span>	*%eax		// call imp

	<span class="enscript-keyword">END_ENTRY</span> __objc_msgSend_uncached

	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">STATIC_ENTRY</span> __objc_msgSend_stret_uncached
	<span class="enscript-keyword">UNWIND</span> __objc_msgSend_stret_uncached, FrameWithNoSaves

	<span class="enscript-keyword">//</span> THIS IS NOT A CALLABLE C FUNCTION
	<span class="enscript-keyword">//</span> Out-of-band edx is the searched class

	<span class="enscript-keyword">//</span> edx is already the class to search
	<span class="enscript-keyword">MethodTableLookup</span> STRET
	<span class="enscript-keyword">jmp</span>	*%eax		// call imp

	<span class="enscript-keyword">END_ENTRY</span> __objc_msgSend_stret_uncached


	<span class="enscript-keyword">STATIC_ENTRY</span> __objc_msgLookup_uncached
	<span class="enscript-keyword">UNWIND</span> __objc_msgLookup_uncached, FrameWithNoSaves

	<span class="enscript-keyword">//</span> THIS IS NOT A CALLABLE C FUNCTION
	<span class="enscript-keyword">//</span> Out-of-band edx is the searched class

	<span class="enscript-keyword">//</span> edx is already the class to search
	<span class="enscript-keyword">MethodTableLookup</span> NORMAL	// eax = IMP
	<span class="enscript-keyword">ret
</span>
	<span class="enscript-keyword">END_ENTRY</span> __objc_msgLookup_uncached

	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">STATIC_ENTRY</span> __objc_msgLookup_stret_uncached
	<span class="enscript-keyword">UNWIND</span> __objc_msgLookup_stret_uncached, FrameWithNoSaves

	<span class="enscript-keyword">//</span> THIS IS NOT A CALLABLE C FUNCTION
	<span class="enscript-keyword">//</span> Out-of-band edx is the searched class

	<span class="enscript-keyword">//</span> edx is already the class to search
	<span class="enscript-keyword">MethodTableLookup</span> STRET		// eax = IMP
	<span class="enscript-keyword">ret
</span>
	<span class="enscript-keyword">END_ENTRY</span> __objc_msgLookup_stret_uncached


/********************************************************************
*
* id _objc_msgForward(id self, SEL _cmd,...)<span class="enscript-comment">;
*
</span>* _objc_msgForward and _objc_msgForward_stret are the externally-callable
*   functions returned by things like method_getImplementation().
* _objc_msgForward_impcache is the function pointer actually stored in
*   method caches.
*
********************************************************************/

	<span class="enscript-keyword">.non_lazy_symbol_pointer
</span><span class="enscript-function-name">L_forward_handler:</span>
	<span class="enscript-keyword">.indirect_symbol</span> __objc_forward_handler
	<span class="enscript-keyword">.long</span> 0
<span class="enscript-function-name">L_forward_stret_handler:</span>
	<span class="enscript-keyword">.indirect_symbol</span> __objc_forward_stret_handler
	<span class="enscript-keyword">.long</span> 0

	<span class="enscript-keyword">STATIC_ENTRY</span> __objc_msgForward_impcache
	<span class="enscript-keyword">//</span> Method cache version
	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">//</span> THIS IS NOT A CALLABLE C FUNCTION
	<span class="enscript-keyword">//</span> Out-of-band condition register is NE for stret, EQ otherwise.

	<span class="enscript-keyword">MESSENGER_START
</span>	<span class="enscript-keyword">nop
</span>	<span class="enscript-keyword">MESSENGER_END_SLOW
</span>
	<span class="enscript-keyword">jne</span>	__objc_msgForward_stret
	<span class="enscript-keyword">jmp</span>	__objc_msgForward
	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">END_ENTRY</span> _objc_msgForward_impcache

	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">ENTRY</span> __objc_msgForward
	<span class="enscript-keyword">//</span> Non-struct return version

	<span class="enscript-keyword">call</span>	1f
<span class="enscript-function-name">1:</span>	popl	%edx
	<span class="enscript-keyword">movl</span>	L_forward_handler-1b(%edx), %edx
	<span class="enscript-keyword">jmp</span>	*(%edx)

	<span class="enscript-keyword">END_ENTRY</span> __objc_msgForward


	<span class="enscript-keyword">ENTRY</span> __objc_msgForward_stret
	<span class="enscript-keyword">//</span> Struct return version

	<span class="enscript-keyword">call</span>	1f
<span class="enscript-function-name">1:</span>	popl	%edx
	<span class="enscript-keyword">movl</span>	L_forward_stret_handler-1b(%edx), %edx
	<span class="enscript-keyword">jmp</span>	*(%edx)

	<span class="enscript-keyword">END_ENTRY</span> __objc_msgForward_stret


	<span class="enscript-keyword">ENTRY</span> _objc_msgSend_debug
	<span class="enscript-keyword">jmp</span>	_objc_msgSend
	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSend_debug

	<span class="enscript-keyword">ENTRY</span> _objc_msgSendSuper2_debug
	<span class="enscript-keyword">jmp</span>	_objc_msgSendSuper2
	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSendSuper2_debug

	<span class="enscript-keyword">ENTRY</span> _objc_msgSend_stret_debug
	<span class="enscript-keyword">jmp</span>	_objc_msgSend_stret
	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSend_stret_debug

	<span class="enscript-keyword">ENTRY</span> _objc_msgSendSuper2_stret_debug
	<span class="enscript-keyword">jmp</span>	_objc_msgSendSuper2_stret
	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSendSuper2_stret_debug

	<span class="enscript-keyword">ENTRY</span> _objc_msgSend_fpret_debug
	<span class="enscript-keyword">jmp</span>	_objc_msgSend_fpret
	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSend_fpret_debug


	<span class="enscript-keyword">ENTRY</span> _objc_msgSend_noarg
	<span class="enscript-keyword">jmp</span>	_objc_msgSend
	<span class="enscript-keyword">END_ENTRY</span> _objc_msgSend_noarg
	<span class="enscript-keyword">
</span>
	<span class="enscript-keyword">ENTRY</span> _method_invoke

	<span class="enscript-keyword">movl</span>	selector(%esp), %ecx
	<span class="enscript-keyword">movl</span>	method_name(%ecx), %edx
	<span class="enscript-keyword">movl</span>	method_imp(%ecx), %eax
	<span class="enscript-keyword">movl</span>	%edx, selector(%esp)
	<span class="enscript-keyword">jmp</span>	*%eax
	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">END_ENTRY</span> _method_invoke


	<span class="enscript-keyword">ENTRY</span> _method_invoke_stret

	<span class="enscript-keyword">movl</span>	selector_stret(%esp), %ecx
	<span class="enscript-keyword">movl</span>	method_name(%ecx), %edx
	<span class="enscript-keyword">movl</span>	method_imp(%ecx), %eax
	<span class="enscript-keyword">movl</span>	%edx, selector_stret(%esp)
	<span class="enscript-keyword">jmp</span>	*%eax
	<span class="enscript-keyword">
</span>	<span class="enscript-keyword">END_ENTRY</span> _method_invoke_stret
	<span class="enscript-keyword">
</span>
.section __DATA,__objc_msg_break
.long 0
.long 0

#endif
</pre>
<hr />
</body></html>